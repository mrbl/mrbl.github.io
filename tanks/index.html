<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>tank</title>
		<script src="https://vk.com/js/api/xd_connection.js?2"  type="text/javascript"></script>
		<style>
			#connect .title {
			display: inline-block;
			width: 65px;
			}
		</style>
	</head>
	<body>
		<div id="connect">
			<form>
				<span class="title">Name:</span>
				<input id="name" type="text" required pattern="[A-Za-z0-9_]{6,}"><br>
				<span class="title">Color:</span>
				<input id="color" type="color"><br>
				<span class="title">Serever:</span>
				<input id="server" type="text" value="test"><br>
				<input type="submit" value="Connect">
			</form>
			<script>
				var viewer_id = Math.floor(Math.random()*1000);
				var viewer_domain = viewer_id; 
				function random(seed) {
				    var x = Math.sin((seed)+1) * 10000;
				    return x - Math.floor(x);
				}
					
				//console.log(document.getElementById("color").value);
				  VK.init(function() { 
				     // API initialization succeeded 
					  viewer_id = new URL(window.location.href).searchParams.get("viewer_id");
				document.getElementById("color").value = '#'+Math.floor(random(viewer_id)*16777215).toString(16);
					  viewer_domain = JSON.parse(new URL(window.location.href).searchParams.get("api_result")).response[0].domain;
				     document.getElementById("name").value = viewer_domain;
				  }, function() { 
				     // API initialization failed 
				     // Can reload page here 
				}, '5.92'); 
				document.getElementById("color").value = '#'+Math.floor(random(viewer_id)*16777215).toString(16);
			</script>
		</div>
		<div id="rooms"></div>
		<div id="game"></div>
	</body>
</html>
